package yega.alogorithms.randomizecontraction;

import java.util.Collection;
import java.util.List;
import java.util.Set;

import org.apache.log4j.Logger;

public class MinCutAlgorithm {

	public static Logger LOG = Logger.getLogger(MinCutAlgorithm.class);
	
	private Integer minCut;
	
	public void find(Collection<Edge> edges) {
		RandomizeContracionAlgorithm rcAlgo = new RandomizeContracionAlgorithm();
		
		for(Edge edge : edges) {
			rcAlgo.loadEdge(edge);
		}
		
		List<Edge> contractedEdges = rcAlgo.contractEdge(rcAlgo.selectRandomEdge());
		
		if(rcAlgo.getGraph().keySet().size() > 2) {
			find(contractedEdges);
		} else {
			minCut = rcAlgo.getEdges().size();
			LOG.info(String.format("Min Cun on this run is [%d]", minCut));
		}
	}
	
	public Integer findMinCut(Set<Edge> edges, Integer timesToRun) {
		Integer tempMinCut = null;
		for(int i =0 ; i < timesToRun; i++) {
			find(edges);
			if(tempMinCut != null && minCut >= tempMinCut) {
				//do nothing
			} else {
				tempMinCut = minCut;
			}
		}
		
		return tempMinCut;
		
	}

	public Integer getMinCut() {
		return minCut;
	}
}
